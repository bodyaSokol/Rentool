<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" type="text/css" href="slick/slick.css"/>
	<link rel="stylesheet" type="text/css" href="slick/slick-theme.css"/>
	<link rel="stylesheet" href="css/style.css">
	<link rel="stylesheet" href="css/media.css">
	<link rel="shortcut icon" type="image/png" href="img/favicon.ico"/>
	<title>Rentool</title>
</head>
<body>
	<div class="nav-main">
		<div class="content_line">
			<div class="nav">
				<div class="logo">
					<a href="index.html"><img src="img/Logo.png" alt="rentool"></a>
				</div>
				<div class="call_us_wrap"><span>Позвони нам </span><a class="call_us" href="tel:+7 (961) 273-93-23">7 (961) 273-93-23</a></div>
				<div  class="write_us_wrap">
					<span>Напиши нам<br></span>
					<a class="email" href="email:rentoolrnd@mail.ru">rentoolrnd@mail.ru</a>
				</div>
			</div>
		</div>
	</div>
	<div class="categories_wrap">
		<div class="content_line">
			<!-- <div class="search">ПОИСК</div> -->
			<div class="category-navigation">
				<a href="index.html" class="category_home">Главная</a><span>&gt;</span><a href="#" class="category_name">Главная</a><span>&gt;</span><a href="#" class="subcategory_name">Главная</a>
			</div>
			<h1 class="product_name">Отбойный молоток</h1>
			<span class="article">Артикул: 7318908392</span>
			<div class="product_info">
				<div class="slider_area">
					<div class="slider-for">
						<!-- <div><img src="img/photo1.png" alt=""></div>
						<div><img src="img/photo2.png" alt=""></div>
						<div><img src="img/photo3.png" alt=""></div>
						<div><img src="img/photo4.png" alt=""></div>
						<div><img src="img/photo5.png" alt=""></div>
						<div><img src="img/photo6.png" alt=""></div> -->
					</div>
					<div class="slider-nav">
						<!-- <div><img src="img/photo1.png" alt=""></div>
						<div><img src="img/photo2.png" alt=""></div>
						<div><img src="img/photo3.png" alt=""></div>
						<div><img src="img/photo4.png" alt=""></div>
						<div><img src="img/photo5.png" alt=""></div>
						<div><img src="img/photo6.png" alt=""></div> -->
					</div>
				</div>
				<div class="price_area">
					<h2 class="price_heading">Стоимость товара / сутки</h2>
					<ul>
						<li><span id="price1" class="bold">0</span> / сутки.</li>
						<li><span id="price2_with_discount" class="bold">0</span> / 5 суток (<span id="price2" class="strike">0</span>).<div class="discount_amount">-10%</div></li>
						<li><span id="price3_with_discount" class="bold">0</span> / 10 суток (<span id="price3" class="strike">0</span>)<div class="discount_amount">-20%</div>.</li>
					</ul>
					<div class="days_amount_area">
						<button id="button_min">-</button>
						<span id="days_amount">1</span>
						<button id="button_plus">+</button>
						<span>Дней аренды</span>
						<div class="price_for_users_block">
							<span class="price_for_user_heading">Итого:</span>
							<span id="price_for_user">0</span>
						</div>
					</div>
					<div class="buttons_area">
						<button class="rent_tool_button">Арендовать инструмент</button>
						<!-- <button class="to_bucket_button">Добавить в корзину.</button> -->
					</div>
				</div>
			</div>	
			<h2 class="description_heading">Характеристики</h2>
			<p class="characteristics_content">0</p>
			<h2 class="description_heading">Описание</h2>
			<p class="description_content">0</p>
		</div>
	</div>
	<div class="footer">
		<div class="content_line">
			<div class="footer_list">
				<div class="footer_item footer_item_flex">
					<img src="img/logo2.png" alt="">
					<a class="yellow_phone" href="tel:+7 (961) 273-93-23">7 (961) 273-93-23</a>
					<a class="email" href="email:rentoolrnd@mail.ru">rentoolrnd@mail.ru</a>
					<button href="#" class="get_instrument" id="order_call">Заказать звонок</button>
				</div>
				<!-- <div class="footer_item">
					<a href="#" class="footer_category">Электроинструменты:</a>
					<ul>
						<li><a href="#" class="footer_subcategory">- Отбойный молоток</a></li>
					</ul>
				</div> -->
			</div>
			<div class="footer_bottom_list">
				<div class="footer_item footer_item_docs">
					<a href="law/processing_of_personal_data.html">Пользовательское соглашение</a>
				</div>
				<div class="footer_item footer_item_docs">
					<a href="law/consent_to_the_processing_of_personal_data.html">Соглашение на обработку данных</a>
				</div>
				<div class="footer_item footer_item_docs footer_item_docs_last">
					<p>“Rentool” 2021 / © Все права защищены!</p>
				</div>
			</div>
		</div>
	</div>
	<div class="modal_rent_product_wrap">
		<form class="modal_rent_product" action="handler.php">
			<div id="buttonx">x</div>
			<h2>Хочу арендовать инструмент</h2>
			<input class="dispnone product_name_input" type="text" name="product_name" value="">
			<input class="dispnone product_input" type="text" name="product" value="">
			<input class="dispnone days_input" type="text" name="days" value="">
			<input class="phone_input" type="text" name="phone" placeholder="Телефон (79612739323)">
			<input class="dispnone request_type" type="text" name="request_type" value="product_request">
			<input class="phone_submit" type="submit" value="Отправить номер">
			<p>Нажимая кнопку "Отправить номер" подтверждаю, что я ознкомился c <a href="law/processing_of_personal_data.html">Положением об обработке персональных данных</a>, и подтверждает согласие с документом <a href="law/consent_to_the_processing_of_personal_data.html">Согласия на обработку персональных данных</a>.</p>
		</form>
	</div>
	<div class="modal_order_call">
		<form class="modal_rent_product" action="handler.php">
			<div id="buttonxphone">x</div>
			<h2>Заказать обратный звонок</h2>
			<input class="phone_input" type="text" name="phone" placeholder="Телефон (79612739323)">
			<input class="dispnone request_type" type="text" name="request_type" value="phone_request">
			<input class="phone_submit" type="submit" value="Отправить номер">
			<p>Нажимая кнопку "Отправить номер" подтверждаю, что я ознкомился c <a href="law/processing_of_personal_data.html">Положением об обработке персональных данных</a>, и подтверждает согласие с документом <a href="law/consent_to_the_processing_of_personal_data.html">Согласия на обработку персональных данных</a>.</p>
		</form>
	</div>
	<div class="preloader"><!-- Элементы прелоадера --></div>
	<script src="js/jquery.js"></script>
	<script type="text/javascript" src="slick/slick.min.js"></script>
	<script type="text/javascript" src="js/main.js"></script>
	<script>
		let productId = location.hash;
		productId=productId.substring(1);
		document.querySelector('.product_input').value=productId;
		document.querySelector('.days_input').value=1;
		$.get(`${api_url}/goods/${productId}`, function(data2) {
			var subcategoryId=data2.category;
			document.querySelector('.product_name').innerHTML=data2.name;
			document.querySelector('.product_name_input').value=data2.name;
			document.querySelector('.article').innerHTML=`Артикул: ${data2.id}`;
			var price_len=data2.prices.length;
			if(price_len==0){var price=1000}else{var price = Number(data2.prices[0].price);}
			document.querySelector('#price1').innerHTML=`${price}₽`;
			document.querySelector('#price2').innerHTML=`${price*5}₽`;
			document.querySelector('#price3').innerHTML=`${price*10}₽`;
			document.querySelector('#price2_with_discount').innerHTML=`${(price*5)*0.9}₽`;
			document.querySelector('#price3_with_discount').innerHTML=`${(price*10)*0.8}₽`;
			document.querySelector('.description_content').innerHTML=data2.description;
			document.querySelector('.characteristics_content').innerHTML=data2.characteristics;
			//итого
			let num = document.querySelector('#days_amount').textContent;
			num=Number(num);
			var result=0;
			if(num<5){
				result=price*num;
			}else if(num<10){
				result=(price*num)*0.9;
			}else if(num>9){
				result=(price*num)*0.8;
			}
			document.querySelector('#price_for_user').innerHTML=result;

			document.getElementById("button_plus").addEventListener('click', function(e) {
				num++;
				document.querySelector('#days_amount').innerHTML=num;
				document.querySelector('.days_input').value=num;
				var result=0;
				if(num<5){
					result=price*num;
				}else if(num<10){
					result=(price*num)*0.9;
				}else if(num>9){
					result=(price*num)*0.8;
				}
				document.querySelector('#price_for_user').innerHTML=result;
			});
			document.getElementById("button_min").addEventListener('click', function(e) {
				if(num>1){
					num--;
					document.querySelector('#days_amount').innerHTML=num;
					document.querySelector('.days_input').value=num;
					var result=0;
					if(num<5){
						result=price*num;
					}else if(num<10){
						result=(price*num)*0.9;
					}else if(num>9){
						result=(price*num)*0.8;
					}
					document.querySelector('#price_for_user').innerHTML=result;
				}
			});
			var photo_mas=data2.photos;
			var photo_len=photo_mas.length;
			if(photo_len==0){
				photo_mas=[{"url":"img/photo1.png"},{"url":"img/photo2.png"},{"url":"img/photo3.png"},{"url":"img/photo4.png"}]
			}
			photo_mas.forEach((photo)=>{
				var photo_div=document.createElement('div');
				var photo_img=document.createElement('img');
				photo_img.src=`${api_url}/uploads/${photo.url}`;
				photo_div.appendChild(photo_img);
				document.querySelector('.slider-for').appendChild(photo_div);
				
				var photo_div_2=document.createElement('div');
				var photo_img_2=document.createElement('img');
				photo_img_2.src=`${api_url}/uploads/${photo.url}`;
				photo_div_2.appendChild(photo_img_2);
				document.querySelector('.slider-nav').appendChild(photo_div_2);
			})
			$('.slider-for').slick({
				slidesToShow: 1,
				slidesToScroll: 1,
				arrows: false,
				fade: true,
				asNavFor: '.slider-nav'
			});
			$('.slider-nav').slick({
				slidesToShow: 3,
				slidesToScroll: 1,
				asNavFor: '.slider-for',
				arrows: true,
				centerMode: true,
				focusOnSelect: true
			});
			//карта сайта
			console.log(data2.prices[0].price);
			$.get(`${api_url}/categories`, function(data) {
				let subcategory = data.find(item => item.id == subcategoryId);
				let categoryId = subcategory.rootCategory.id;
				let category = data.find(item => item.id == categoryId);
				document.querySelector('.category_name').innerHTML=category.name;
				document.querySelector('.category_name').href=`subcategory.html#${categoryId}`;
				document.querySelector('.subcategory_name').innerHTML=subcategory.name;
				document.querySelector('.subcategory_name').href=`products_list.html#${subcategoryId}`;
			});
		}).fail(function() {
			document.location.replace("index.html");
		});
		$.get(`${api_url}/categories`, function(data) {
			let categories = data.filter(item => item.rootCategory==null);
			categories.forEach((item)=>{
				var footer_item=document.createElement('div');
				footer_item.className='footer_item';
				document.querySelector('.footer_list').appendChild(footer_item);
				//next
				var footer_category=document.createElement('a');
		 		footer_category.className='footer_category';
	 			footer_category.href=`subcategory.html#${item.id}`;
	 			footer_category.innerHTML=item.name;
	 			footer_item.appendChild(footer_category);
	 			// next
	 			var footer_ul=document.createElement('ul');
	 			footer_item.appendChild(footer_ul);
	 			// next
	 				let subcategories=data.filter(item2 => item2.rootCategory!=null);
	 				subcategories = subcategories.filter(item2 => item2.rootCategory.id==item.id)
	 				subcategories.forEach((subitem)=>{
	 					var subcategory_li=document.createElement('li');
		 				var footer_subcategory=document.createElement('a');
			 			footer_subcategory.className='footer_subcategory';
			 			footer_subcategory.href=`products_list.html#${subitem.id}`;
			 			footer_subcategory.innerHTML=`- ${subitem.name}`;
			 			footer_ul.appendChild(subcategory_li);
			 			subcategory_li.appendChild(footer_subcategory);
	 				})
			});
		});
		document.getElementById("buttonx").addEventListener('click', function(e) {
			document.querySelector('.modal_rent_product_wrap').classList.remove('modal_rent_product_wrap_active');
		});
		
		document.querySelector(".rent_tool_button").addEventListener('click', function(e) {
			document.querySelector('.modal_rent_product_wrap').classList.add('modal_rent_product_wrap_active');
		});
	</script>
</body>
</html>